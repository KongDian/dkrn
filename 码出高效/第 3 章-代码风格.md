# 第 3 章 代码风格



## 3.1 命名规范

为了统一代码风格，元素命名要遵守以下约定。

1. 命名符合语言基本特性

   在 Java 中，所有代码元素的命名均不能以下划线或美元符号开始或结束。

2. 命名体现代码元素特征

   面向对象代码元素的命名形式分为两大类，即首字母大写的 UpperCamelCase 和首字母小写的 lowerCamelCase，前者俗称大驼峰，后者俗称小驼峰。类名采用大驼峰形式，一般为名词。方法名一般采用小驼峰形式，一般为动词，与参数组成动宾结构。变量包括参数、成员变量、局部变量等，也采用小驼峰形式。常量命名一般，字母全部大写，单词之间用下划线连接。

   推荐 Java 命名时，以下列方式体现元素特征：

   - 包统一使用小写，点分隔符之间有且仅有一个自然语义的英语单词。包名统一使用单数形式，但是类名如果有复数含义，则可以使用复数形式。
   - 抽象类命名使用 Abstract 或 Base 开头；异常类命名使用 Exception 结尾；测试类命名以它要测试的类名开始，以 Test 结尾。
   - 类型与中括号紧挨相连来定义数组。
   - 枚举类名带上 Enum 后缀，枚举成员需要全部大写，单词间用下划线隔开。

3. 命名最好望文知义

   在代码元素命名时做到望文知义，从而减少注释内容，达到自解释的目的。

   

### 3.1.1 常量

常量是指在作用域内保持不变的值，一般使用 final 关键字修饰，根据作用域区分，分为全局常量、类内常量、局部常量。全局常量常指类的公开静态属性，使用 public static final 修饰；类内常量是私有静态属性，使用 private static final 修饰；局部常量分为方法常量和参数常量，前者是在方法或代码块内定义的常量，后者是在定义形式参数时，增加的 final 标识，表示此参数不能被修改。全局常量和类常量采用字母全部大写、单词之间加下划线的方式。而局部常量采用小驼峰形式。

常使用 Enum 枚举类和抽象类的全局常量来消除魔法值。

系统成长到某个阶段后，重构是一种必然选择。

常量需要赋予一个有意义的名称目的有两个：第一、望文知义，方便理解；第二、后期多次使用能够保证值出同源。



### 3.1.2 变量

变量，从广义上来说，在程序中变量是一切通过分配内存并赋值的量，分为不可变量（常量）和可变量。从狭义来说，变量仅指在程序运行过程中可以改变其值的量，包括成员变量和局部可变变量等。

一般情况下，变量命名需要通过满足小驼峰格式。特殊情况，在定义成员变量时，特别是在 POJO 类中，针对布尔类型的变量，命名不要加 is 前缀，否则部分框架解析会引起序列化错误。



## 3.2 代码展示风格

### 3.2.1 缩进、空格与空行

1. 缩进

   由于不同编辑器对 Tab 的解析不同，推荐使用 4 个空格缩进，而禁用 Tab 键。

2. 空格

   空格使用有如下约定：

   （1） 任何二目、三目运算符的左右两边必须加一个空格。

   （2）注释的双斜线与注释内容之间有且仅有一个空格。

   （3）方法参数在定义和传入时，多个参数逗号后边必须加空格。

   （4）没有必要增加若干空格使变量的赋值等号与上一行对应位置等号对齐。

   （5）如果大括号内为空，则简洁的写成{}即可，大括号中间无须换行和空格。

   （6）左右小括号与括号内部的相邻字符中间不要出现空格。

   （7）左大括号前需要加空格。

3. 空行

   在方法定义之后、属性定义与方法之间、不同逻辑、不同语义、不同业务代码之间都要通过空格来分隔。



### 3.2.2 换行与高度

1. 换行

   约定单行字符不超过 120 个，超出则需换行，换行时遵循如下原则：

   （1）第二行相对第一行缩进4个空格，从第三行开始，不再继续缩进。

   （2）运算符与下文一起换行。

   （3）方法调用的点符号与下文一起换行。

   （4）方法调用时，多个参数需要换行时，在逗号后进行。

   （5）在括号前不要换行。

2. 方法行数限制

   约定单个方法不超过 80 行。



### 3.2.3 控制语句

控制语句必须遵循如下约定：

（1）在 if、else、for、while、do-while 语句中必须使用大括号。即使只有一行代码，避免采用单行的编码方式。

（2）不要在条件判断中执行其它复杂的语句，将复杂逻辑判断的结果赋值给一个有意义的布尔变量名，以提高可读性。

（3） 多层嵌套不能超过 3 层。

（4）避免采用取反逻辑运算符。取反逻辑不利于快速理解，并且取反逻辑写法必然存在对应的正向逻辑写法。



## 3.3 代码注释

### 3.3.1 注释三要素

书写注释需要满足三要素。

1. Nothing is strange 
2. Less is more
3. Advance with the times

### 3.3.2 注释格式

注释格式主要分为两种：一种是 Javadoc 规范，另一种是简单注释。

1. Javadoc 规范

   类、类属性和方法的注释必须遵循 Javadoc 规范，使用文档注释（/** */）的格式。

   需要强调对枚举的注释是必需的。

   （1）枚举实在太特殊了，它的代码极为稳定。

   （2）注释内容不仅限于解释属性值含义，还可以包括注意事项、业务逻辑。

   （3）枚举类的删除或者修改都存在很大风险。

2. 简单注释

   特别强调此类注释不允许写在代码后方，必须写在代码上方，避免注释的参差不齐，导致代码版式混乱。